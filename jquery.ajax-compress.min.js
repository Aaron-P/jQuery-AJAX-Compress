/*
AJAX Compress; A plugin for jQuery to compress AJAX request bodies.
Copyright (C) 2013 Aaron Papp <https://github.com/Aaron-P>

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/
(function(Ga){function X(){function m(){this.dl=this.fc=0}function B(){this.extra_bits=this.static_tree=this.dyn_tree=null;this.max_code=this.max_length=this.elems=this.extra_base=0}function u(c,e,b,a){this.good_length=c;this.max_lazy=e;this.nice_length=b;this.max_chain=a}function z(){this.next=null;this.len=0;this.ptr=[];this.off=0}function n(c){Y[x+C++]=c;if(x+C===$a){var e;if(0!==C){null!==Z?(c=Z,Z=Z.next):c=new z;c.next=null;c.len=c.off=0;null===v?v=wa=c:wa=wa.next=c;c.len=C-x;for(e=0;e<c.len;e++)c.ptr[e]=
Y[x+e];C=x=0}}}function l(c){c&=65535;x+C<$a-2?(Y[x+C++]=c&255,Y[x+C++]=c>>>8):(n(c&255),n(c>>>8))}function U(c,e,b){return c[e].fc<c[b].fc||c[e].fc===c[b].fc&&I[e]<=I[b]}function ab(c,e,b){var a;for(a=0;a<b&&Ha<xa.length;a++)c[e+a]=xa.charCodeAt(Ha++)&255;return a}function T(c){var e=bb,b=f,a=E,d,j=f>ka?f-ka:da,Ia=f+la,V=h[b+a-1],k=h[b+a],l,g;E>=cb&&(e>>=2);do if(d=c,!(h[d+a]!==k||h[d+a-1]!==V||h[d]!==h[b]||h[++d]!==h[b+1])){b+=2;for(d++;b<Ia;){g=!1;for(l=0;8>l;l+=1)if(b+=1,d+=1,h[b]!==h[d]){g=!0;
break}if(g)break}d=la-(Ia-b);b=Ia-la;if(d>a){ea=c;a=d;if(db){if(d>=la)break}else if(d>=eb)break;V=h[b+a-1];k=h[b+a]}}while((c=w[c&ma])>j&&0!==--e);return a}function na(){var c,e,b=rb-g-f;if(-1===b)b--;else if(f>=k+ka){for(c=0;c<k;c++)h[c]=h[c+k];ea-=k;f-=k;J-=k;for(c=0;c<Ja;c++)e=w[k+c],w[k+c]=e>=k?e-k:da;for(c=0;c<k;c++)e=w[c],w[c]=e>=k?e-k:da;b+=k}M||(c=ab(h,f+g,b),0>=c?M=!0:g+=c)}function X(c,e,b){var a;if(!Ka){if(!M){F=K=0;var d,j;if(0===$[0].dl){G.dyn_tree=L;G.static_tree=N;G.extra_bits=La;G.extra_base=
oa+1;G.elems=pa;G.max_length=qa;G.max_code=0;H.dyn_tree=O;H.static_tree=$;H.extra_bits=ra;H.extra_base=0;H.elems=aa;H.max_length=qa;H.max_code=0;P.dyn_tree=p;P.static_tree=null;P.extra_bits=sb;P.extra_base=0;P.elems=ya;P.max_length=tb;for(j=d=P.max_code=0;j<fb-1;j++){Ma[j]=d;for(a=0;a<1<<La[j];a++)sa[d++]=j}sa[d-1]=j;for(j=d=0;16>j;j++){za[j]=d;for(a=0;a<1<<ra[j];a++)ba[d++]=j}for(d>>=7;j<aa;j++){za[j]=d<<7;for(a=0;a<1<<ra[j]-7;a++)ba[256+d++]=j}for(a=0;a<=qa;a++)A[a]=0;for(a=0;143>=a;)N[a++].dl=
8,A[8]++;for(;255>=a;)N[a++].dl=9,A[9]++;for(;279>=a;)N[a++].dl=7,A[7]++;for(;287>=a;)N[a++].dl=8,A[8]++;gb(N,pa+1);for(a=0;a<aa;a++)$[a].dl=5,$[a].fc=hb(a,5);ib()}for(a=0;a<Ja;a++)w[k+a]=da;Na=Aa[W].max_lazy;cb=Aa[W].good_length;db||(eb=Aa[W].nice_length);bb=Aa[W].max_chain;J=f=0;g=ab(h,0,2*k);if(0>=g)M=!0,g=0;else{for(M=!1;g<Ba&&!M;)na();for(a=q=0;a<y-1;a++)q=(q<<fa^h[a]&255)&ga}v=null;x=C=0;3>=W?(E=y-1,r=0):(r=y-1,ta=!1);Ca=!1}Ka=!0;if(0===g)return Ca=!0,0}if((a=jb(c,e,b))===b)return b;if(Ca)return a;
if(3>=W)for(;0!==g&&null===v;){q=(q<<fa^h[f+y-1]&255)&ga;D=w[k+q];w[f&ma]=D;w[k+q]=f;D!==da&&f-D<=ka&&(r=T(D),r>g&&(r=g));if(r>=y)if(j=ua(f-ea,r-y),g-=r,r<=Na){r--;do f++,q=(q<<fa^h[f+y-1]&255)&ga,D=w[k+q],w[f&ma]=D,w[k+q]=f;while(0!==--r);f++}else f+=r,r=0,q=h[f]&255,q=(q<<fa^h[f+1]&255)&ga;else j=ua(0,h[f]&255),g--,f++;j&&(Da(0),J=f);for(;g<Ba&&!M;)na()}else for(;0!==g&&null===v;){q=(q<<fa^h[f+y-1]&255)&ga;D=w[k+q];w[f&ma]=D;w[k+q]=f;E=r;kb=ea;r=y-1;D!==da&&(E<Na&&f-D<=ka)&&(r=T(D),r>g&&(r=g),r===
y&&f-ea>ub&&r--);if(E>=y&&r<=E){j=ua(f-1-kb,E-y);g-=E-1;E-=2;do f++,q=(q<<fa^h[f+y-1]&255)&ga,D=w[k+q],w[f&ma]=D,w[k+q]=f;while(0!==--E);ta=!1;r=y-1;f++;j&&(Da(0),J=f)}else ta?ua(0,h[f-1]&255)&&(Da(0),J=f):ta=!0,f++,g--;for(;g<Ba&&!M;)na()}0===g&&(ta&&ua(0,h[f-1]&255),Da(1),Ca=!0);return a+jb(c,a+e,b-a)}function jb(c,e,b){for(var a=0,d,j;null!==v&&a<b;){d=b-a;d>v.len&&(d=v.len);for(j=0;j<d;j++)c[e+a+j]=v.ptr[v.off+j];v.off+=d;v.len-=d;a+=d;0===v.len&&(d=v,v=v.next,d.next=Z,Z=d)}if(a===b)return a;
if(x<C){d=b-a;d>C-x&&(d=C-x);for(j=0;j<d;j++)c[e+a+j]=Y[x+j];x+=d;a+=d;C===x&&(C=x=0)}return a}function ib(){var c;for(c=0;c<pa;c++)L[c].fc=0;for(c=0;c<aa;c++)O[c].fc=0;for(c=0;c<ya;c++)p[c].fc=0;L[Oa].fc=1;ha=Q=Ea=Pa=R=ia=0;va=1}function Qa(c,e){for(var b=s[e],a=e<<1;a<=S;){a<S&&U(c,s[a+1],s[a])&&a++;if(U(c,b,s[a]))break;s[e]=s[a];e=a;a<<=1}s[e]=b}function gb(c,e){var b=[],a=0,d;for(d=1;d<=qa;d++)a=a+A[d-1]<<1,b[d]=a;for(a=0;a<=e;a++)d=c[a].dl,0!==d&&(c[a].fc=hb(b[d]++,d))}function Ra(c){var e=c.dyn_tree,
b=c.static_tree,a=c.elems,d,j=-1,f=a;S=0;ja=Sa;for(d=0;d<a;d++)0!==e[d].fc?(s[++S]=j=d,I[d]=0):e[d].dl=0;for(;2>S;)d=s[++S]=2>j?++j:0,e[d].fc=1,I[d]=0,R--,null!==b&&(ia-=b[d].dl);c.max_code=j;for(d=S>>1;1<=d;d--)Qa(e,d);do d=s[ca],s[ca]=s[S--],Qa(e,ca),b=s[ca],s[--ja]=d,s[--ja]=b,e[f].fc=e[d].fc+e[b].fc,I[f]=I[d]>I[b]+1?I[d]:I[b]+1,e[d].dl=e[b].dl=f,s[ca]=f++,Qa(e,ca);while(2<=S);s[--ja]=s[ca];f=c.dyn_tree;d=c.extra_bits;var a=c.extra_base,b=c.max_code,V=c.max_length,l=c.static_tree,k=0,h,g,m,n;for(g=
0;g<=qa;g++)A[g]=0;f[s[ja]].dl=0;for(c=ja+1;c<Sa;c++)h=s[c],g=f[f[h].dl].dl+1,g>V&&(g=V,k++),f[h].dl=g,h>b||(A[g]++,m=0,h>=a&&(m=d[h-a]),n=f[h].fc,R+=n*(g+m),null!==l&&(ia+=n*(l[h].dl+m)));if(0!==k){do{for(g=V-1;0===A[g];)g--;A[g]--;A[g+1]+=2;A[V]--;k-=2}while(0<k);for(g=V;0!==g;g--)for(h=A[g];0!==h;)d=s[--c],d>b||(f[d].dl!==g&&(R+=(g-f[d].dl)*f[d].fc,f[d].fc=g),h--)}gb(e,j)}function lb(c,e){var b,a,d=-1,j=c[0].dl,f=0,g=7,h=4;0===j&&(g=138,h=3);c[e+1].dl=65535;for(b=0;b<=e;b++)a=j,j=c[b+1].dl,++f<
g&&a===j||(f<h?p[a].fc+=f:0!==a?(a!==d&&p[a].fc++,p[Ta].fc++):10>=f?p[Ua].fc++:p[Va].fc++,f=0,d=a,0===j?(g=138,h=3):a===j?(g=6,h=3):(g=7,h=4))}function mb(c,e){var b,a,d=-1,f=c[0].dl,g=0,h=7,k=4;0===f&&(h=138,k=3);for(b=0;b<=e;b++)if(a=f,f=c[b+1].dl,!(++g<h&&a===f)){if(g<k){do t(p[a].fc,p[a].dl);while(0!==--g)}else 0!==a?(a!==d&&(t(p[a].fc,p[a].dl),g--),t(p[Ta].fc,p[Ta].dl),t(g-3,2)):10>=g?(t(p[Ua].fc,p[Ua].dl),t(g-3,3)):(t(p[Va].fc,p[Va].dl),t(g-11,7));g=0;d=a;0===f?(h=138,k=3):a===f?(h=6,k=3):(h=
7,k=4)}}function Da(c){var e,b,a,d;d=f-J;Fa[Pa]=ha;Ra(G);Ra(H);lb(L,G.max_code);lb(O,H.max_code);Ra(P);for(a=ya-1;3<=a&&0===p[nb[a]].dl;a--);R+=3*(a+1)+14;e=R+3+7>>3;b=ia+3+7>>3;b<=e&&(e=b);if(d+4<=e&&0<=J){t((Ga<<1)+c,3);ob();l(d);l(~d);for(a=0;a<d;a++)n(h[J+a])}else if(b===e)t((Ya<<1)+c,3),pb(N,$);else{t((Za<<1)+c,3);d=G.max_code+1;e=H.max_code+1;a+=1;t(d-257,5);t(e-1,5);t(a-4,4);for(b=0;b<a;b++)t(p[nb[b]].dl,3);mb(L,d-1);mb(O,e-1);pb(L,O)}ib();0!==c&&ob()}function ua(c,e){Wa[Q++]=e;0===c?L[e].fc++:
(c--,L[sa[e]+oa+1].fc++,O[(256>c?ba[c]:ba[256+(c>>7)])&255].fc++,Xa[Ea++]=c,ha|=va);va<<=1;0===(Q&7)&&(Fa[Pa++]=ha,ha=0,va=1);if(2<W&&0===(Q&4095)){var b=8*Q,a=f-J,d;for(d=0;d<aa;d++)b+=O[d].fc*(5+ra[d]);if(Ea<~~(Q/2)&&b>>3<~~(a/2))return!0}return Q===qb-1||Ea===vb}function pb(c,e){var b,a=0,d=0,f=0,g=0,h,k;if(0!==Q){do 0===(a&7)&&(g=Fa[f++]),b=Wa[a++]&255,0===(g&1)?t(c[b].fc,c[b].dl):(h=sa[b],t(c[h+oa+1].fc,c[h+oa+1].dl),k=La[h],0!==k&&(b-=Ma[h],t(b,k)),b=Xa[d++],h=(256>b?ba[b]:ba[256+(b>>7)])&255,
t(e[h].fc,e[h].dl),k=ra[h],0!==k&&(b-=za[h],t(b,k))),g>>=1;while(a<Q)}t(c[Oa].fc,c[Oa].dl)}function t(c,e){F>16-e?(K|=c<<F,l(K),K=c>>16-F,F+=e-16):(K|=c<<F,F+=e)}function hb(c,e){var b=0;do b|=c&1,c>>=1,b<<=1;while(0<--e);return b>>1}function ob(){8<F?l(K):0<F&&n(K);F=K=0}var k=32768,Ga=0,Ya=1,Za=2,db=!0,$a=8192,rb=2*k,y=3,la=258,qb=8192,vb=qb,Ja=32768,ga=Ja-1,ma=k-1,da=0,ub=4096,Ba=la+y+1,ka=k-Ba,ca=1,qa=15,tb=7,fb=29,oa=256,Oa=256,pa=oa+1+fb,aa=30,ya=19,Ta=16,Ua=17,Va=18,Sa=2*pa+1,fa=~~((15+y-1)/
y),La=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ra=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],sb=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],nb=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Aa=[new u(0,0,0,0),new u(4,4,8,4),new u(4,5,16,8),new u(4,6,32,32),new u(4,4,16,16),new u(8,16,32,32),new u(8,16,128,128),new u(8,32,128,256),new u(32,128,258,1024),new u(32,258,258,4096)],Z,v,wa,Ka,Y=null,C,x,Ca,h,Xa,Wa,w,K,F,J,q,D,kb,ta,r,E,f,ea,M,g,bb,Na,W,cb,eb,L,
O,N,$,p,G,H,P,A,s,S,ja,I,sa,ba,Ma,za,Fa,Q,Ea,Pa,ha,va,R,ia,xa,Ha;this.compress=function(c,e){var b,a,d,f="";xa=c;Ha=0;void 0===e&&(e=6);(b=e)?1>b?b=1:9<b&&(b=9):b=6;W=b;M=Ka=!1;if(null!==Y)throw Error("Deflate output buffer not null.");wa=v=Z=null;Y=[];h=[];Xa=[];Wa=[];w=[];L=[];for(b=0;b<Sa;b++)L[b]=new m;O=[];for(b=0;b<2*aa+1;b++)O[b]=new m;N=[];for(b=0;b<pa+2;b++)N[b]=new m;$=[];for(b=0;b<aa;b++)$[b]=new m;p=[];for(b=0;b<2*ya+1;b++)p[b]=new m;G=new B;H=new B;P=new B;A=[];s=[];I=[];sa=[];ba=[];
Ma=[];za=[];Fa=[];for(d=[];0<(b=X(d,0,1024));)for(a=0;a<b;a++)f+=String.fromCharCode(d[a]);xa=null;return f}}function Ya(){return this.crc32=function(m){var B=-1,u,z,n,l;u=0;for(n=m.length;u<n;u++){l=(B^m.charCodeAt(u))&255;for(z=0;8>z;z++)l=1===(l&1)?l>>>1^3988292384:l>>>1;B=B>>>8^l}return(B^-1)>>>0}}function Za(){function m(m,n){for(var l="";n--;)l+=String.fromCharCode(m&255),m>>>=8;return l}var B=new Ya,u=new X;this.compress=function(z,n){var l,U;l="\x00";var T=m(B(z),4),X=m(z.length%4294967295,
4);void 0===n&&(n=6);1>n&&(n=1);9<n&&(n=9);1===n&&(l="\x04");9===n&&(l="\x02");l="\x1f\x8b\b\x00\x00\x00\x00\x00"+l+"\x03";try{U=u.compress(z,n)}catch(na){throw na;}return l+U+(T+X)}}var T={gzip:{level_default:6,level_min:1,level_max:9,compressorObject:function(){return new Za}},deflate:{level_default:6,level_min:1,level_max:9,compressorObject:function(){return new X}}};Ga.ajaxPrefilter(function(m,B,u){B=m.type.toUpperCase();var z="gzip",n=6,l,U;if(m.compress&&("POST"===B||"PUT"===B)){m.compressionType&&
T[m.compressionType]&&(z=m.compressionType);m.compressionLevel&&(T[z].level_min<=m.compressionLevel&&m.compressionLevel<=T[z].level_max)&&(n=m.compressionLevel);try{l=T[z].compressorObject(),U=l.compress(m.data,n),u.setRequestHeader("X-Content-Encoding",z),m.data=U}catch(X){}}})})(jQuery);